---
# 🏫 Kyonggi University data analysis project

# </br> <주제>
</br> :pencil2: 큰 주제 : 특정 카테고리 상품 (니트, 맨투맨)에 대한 리뷰 분석을 바탕으로 소비자의 구매 결정에 도움을 줄 수 있는 인사이트 제공 

- 세부 주제 : 고객의 리뷰를 바탕으로 니트의 총장, 어깨너비, 가슴단면, 소매길이가 큰지 작은지에 대한 dashboard 제공

![첫-번째-주제-동영상](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/86e64c00-5036-44bd-94fe-32dcd54c5bae)

</br>

- 세부 주제 : 키, 몸무게, 원하는 핏 (예를 들면, 총장이 길지만 소매는 짧음)을 바탕으로 니트, 맨투맨의 총장, 어깨넓이, 가슴둘레, 소매 길이를 측정

![두-번째-주제-동영상](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/c6a5b5a3-a51f-4e3b-af80-21cf3b10d14e)
 
```
Q. 왜 많은 카테고리 중에서 니트, 맨투맨을 선택한 것인가?
=> 니트, 맨투맨은 많은 상품이 있고 그에 따라 많은 리뷰를 보유
=> S, M, L, XL 잘 구분되어 있음. (사이즈 추천 모델링에 활용하기 위한 목적)
```

</br> 📖 참고 문헌

- 세바스찬 라시카 [머신러닝 교과서 with 파이썬. 사이키럿. 텐서클로]
- 라기 (충북대학교 전기 전자 정보 컴퓨터학부 컴퓨터과학과(원) 국내석사)[고객 신용등급평가에서 고객 신용정보 기반 기계학습 알고리즘 성능 비교]

</br> 📁 참고 프로젝트 

|프로젝트명|사이트|
|------|---|
|온라인 쇼핑몰 데이터를 활용하여 비즈니스적 가치 창출하기|https://github.com/jyjnote/Zigzag-|
|리뷰 기반 의류 사이즈 추천시스템|https://www.slideshare.net/slideshow/17-boaz-sizoah/255973431|

# </br> 첫 번째 주제 :  고객의 리뷰를 바탕으로 총장, 어깨너비, 가슴단면, 소매길이가 큰지 작은지에 대한 모델링 과정 후 dashboard 제공
</br> :pushpin: 1. 크롤링을 통한 데이터 수집 

- selenium과 beautifulsoup을 이용해 약 56,000개의 리뷰 데이터를 수집
- 무신사에서 리뷰 데이터를 수집한 이유는 남성 의류 쇼핑몰 중에서 가장 많은 상품을 보유하고 있으며 그에 따른 다량의 리뷰가 확보되어 있음

|Nickname|Product_Name|Review|Gender|Height|weight|Size|Length|Sholder|Chest|Sleeve|
|------|---|------|---|------|---|------|---|------|---|------|
|LV.3 jhcjhc|스웨트셔츠 [블랙]|생략|남성|172cm|70kg|M|71.0|48.5|54.5|63.0|
|LV.4 applebite|스웨트셔츠 [블랙]|생략|남성|167cm|63kg|M|71.0|48.5|54.5|63.0|
|LV.4 지진1|스웨트셔츠 [블랙]|생략|남성|174cm|53kg|M|71.0|48.5|54.5|63.0|
|LV.6 구니구니구니|스웨트셔츠 [블랙]|생략|남성|170cm|65kg|M|71.0|48.5|54.5|63.0|	
|LV.4 메론맛크롱|스웨트셔츠 [블랙]|생략|남성|172cm|70kg|M|71.0|48.5|54.5|63.0|

```
Nickname : Nickname은 비식별화되어 있음
Product_Name : 약 120개 제품의 리뷰가 쌓여있음
Review : /n, ㅎㅎ, ㅠㅠ, 이모티콘, 띄어쓰기에 대한 전처리 작업이 필요
ex) 옷이 너무 마음에 들어요 /n 근데 핏이 저한테는너무 크네요 ㅠㅠ😭
Gender : 남, 여
Length, Sholder, Chest, Sleeve의 경우에는 무신사에서 제공하는 제품별 사이즈를 참고하여 기입
```
</br> :pushpin: 2. train_data 변수에 대한 설명 
- 오직 리뷰 데이터 5,000개를 train_data로 구성 
- 모델링을 진핼할 때 target 변수는 '총장 길다', '종장 짧다', '어깨너비 크다', '어깨너비 작다', '가슴단면 크다', '가슴단면 작다', '소매길이 길다', 소매길이 짧다'로 라벨링 진행
- 리뷰는 자음과 모음, 그리고 이모티콘을 제거하는 전처리 과정을 진행

|변수 / 형태|종류|단위|비고|
|------|---|------|---|
|리뷰|질적 데이터 / 명목형|생략|한글 텍스트로 구성|
|총장 길다|질적 데이터 / 순서형|생략|길다 = 1, 그렇지 않다 = 0|
|총장 짧다|질적 데이터 / 순서형|생략|짧다 = 1, 그렇지 않다 = 0|
|어깨너비 크다|질적 데이터 / 순서형|생략|크다 = 1, 그렇지 않다 = 0|
|어깨너비 작다|질적 데이터 / 순서형|생략|작다 = 1, 그렇지 않다 = 0|	
|가슴단면 크다|질적 데이터 / 순서형|생략|크다 = 1, 그렇지 않다 = 0|
|가슴단면 작다|절적 데이터 / 순서형|생략|작다 = 1, 그렇지 않다 = 0|172cm|
|소매길이 길다|질적 데이터 / 순서형|생략|길다 = 1, 그렇지 않다 = 0|172cm|
|소매길이 짧다|질적 데이터 / 순서형|생략|짧다 = 1, 그렇지 않다 = 0|172cm|

```
Q. 라벨링의 기준은 무엇인가?

1. 총장, 어깨너비, 가슴단면, 소매길이를 지칭하지 않고 '오버핏이다, 사이즈가 크다, 루즈핏이다' 이런식으로 리뷰를 쓰는 경우가 많음
=> 이와 같은 경우에는 총장, 어깨너비, 가슴단면, 소매길이를 모두 크다(=1)로 라벨링을 진행합니다. 

2. '팔 혹시나 짧을까 했는데 여유 있어용.'과 같이 구체적인 리뷰 다수 존재하고 있음을 확인할 수 있음.
=> 이와 같은 경우에는 '소매가 짧다'로 라벨링을 진행

3. 핏이 이쁘다
=> 오버핏인지, 정핏인지 구분되지 않음
=> 따라서 이와 같은 경우에는 모든 항목에 0을 부여

4. 어깨가 편하다
=> 어깨가 편하면 여유로운 핏이기 때문에 편하다고 판단
=> 이와 같은 경우에는 '어깨너비 크다'로 라벨링을 진행

5. 기장이 크롭하다.
=> '길이가 짧다'로 라벨링 진행

6. 사이즈가 넉넉해서 좋은데 기장이 길다
=> 이는 모든 카테고리를 큰 것으로 라벨링을 진행

7. '세탁 후 줄어든다'와 같은 구매 이후 변경 사항에 대해서는 고려 x

8. 기장이 짧은 오버핏
=> 기장만 0으로 라벨링 하고 나머지 카테고리는 큰 것으로 라벨링을 진행

9. 마른 체형인데 체형 보완이 됐다.
=> 체형 보온이 되는 옷은 폼에 전체적으로 큰 것이기 때문에 모든 카테고리가 큰 것으로 라벨링을 진행
```
</br> :pushpin: 3. 모델링 작업 계획서 
</br> <ins> 가. train_data를 학습데이터와 테스트데이터로 분류</ins>
- 학습데이터와 테스트데이터의 대상 비율이 다른 경우, 학습데이터에 국한된 학습이 행해져 모집단을 대표하지 않는 패턴이 발생하게 된다.
- 이는 모델의 성능을 저하시키는 결과를 초래시킬 수 있다. 

||총장 길다|총장 짧다|어깨너비 크다|어깨너비 좁다|가슴 단면 크다 |가슴 단면 작다|소매 길이 길다|소매 길이 짧다|
|------|---|------|---|------|---|------|---|------|
|0|81.938003|97.803271|82.377349|99.243349|82.523798|99.145716|82.401757|98.901635|
|1|18.061887|2.196729|17.622651|0.756651|17.476202|0.854284|17.598243|1.098365|

- 즉, 학습데이터에서도 위와 같은 비율을 유지시키고 테스트데이터에도 위와 깉은 비율을 유지시키는 것이 중요
- 현실적으로 6개의 비율을 동시에 동일하게 유시시키면서 학습데이터와 테스트데이터를 분류하는 것은 쉽지 않음
- 이는 'MultilabelStratifiedKFold'를 활용하여 분류 작업이 행해짐
- 각 비율을 최대한 유지시키면서 학습데이터와 테스트데이터 분류

</br> <ins> 나. accuracy를 사용하여 모델의 성능을 평가하지 않은 이유</ins>

|||실제 정답|실제 정답|
|------|---|------|---|
|||True|False|
|예측값|True|True Positive (TP)|False Positive (FP)|
|예측값|False|False Negative (FN)|True Negative (TN)|

- (TP + TP) / (TP + FN + FP + TN)
- accuracy의 경우에는 class의 비율이 비슷한 경우에 한해서 모델의 성능을 평가하는 지표로 사용하기에 적합
- 다만, 이 주제의 경우에는 모든 target의 class 비율이 0이 압도적으로 높은 상황이기 때문에 단순히 accuracy로 모델의 성능을 평가하는 것은 적합 x

</br> <ins> 다. f1_score를 사용하여 모델의 성능을 평가한 이유</ins>
- precision = (True Positive) / (True Positive + False Positive)
- Recall = (True Positive) / (True Positive + False Negative)
- f1_score = 2 * (Precision * Recall) / (Precision + Recall)
- 일반적으로 f1_score의 경우에는 데이터셋의 target class 비율이 불균형한 경우에 사용
- f1_score 사용 예시

||총장 길다|총장 짧다|어깨너비 크다|어깨너비 좁다|가슴 단면 크다 |가슴 단면 작다|소매 길이 길다|소매 길이 짧다|
|------|---|------|---|------|---|------|---|------|
|f1_score|74|54|89|76|57|92|45|83|

- f1_score의 평균을 통해 모델의 성능을 평가하게 되면 target 중에서도 잘 맞추지 못한 것을 고려한 모델의 종합적은 성능이 측정되는 것이다. 

</br> <ins> 라. NLP classification model </ins>

- cnn, rnn, tifid를 통해 layer를 구성하여 모델링 과정을 진행했지만 모델의 성능이 그렇게 좋지 않았음.
- Hugging face에 존재하는 다양한 사전학습 모델을 미세조정하여 모델링 과정을 진행

|사전학습모델 이름|'kykim/bert-kor-base'|'BM-K/KoDiffCSE-RoBERTa'|'smilegate-ai/kor_unsmile'|'team-lucid/deberta-v3-base-korean'|
|------|---|------|---|------|
|f1_score|0.83|0.77|0.77|0.75|

- kykim/bert-kor-base 를 이용하여 target 변수를 예측하는 모델링 과정을 진행
- 총장, 어깨너비, 가슴단면, 소매길에 대한 시각화 자료를 제시하 위해서는 모델을 통해 예측된 자료를 다시 한번 전처리 과정을 진행

|총장 길다|총장 짧다|총장|
|------|---|------|
|1|0|1 (길다) |
|0|1|-1 (짧다) |
|0|0|0 (정핏) |
|1|1|삭제|

- 총장 길다 = 1, 총장 짧다 = 1의 경우에는 모델이 잘 못 예측한 것으로 판별
- 다음과 같이 잘못 예측된 리뷰는 삭제
- 어깨너비, 가슴단면, 소매길이도 똑같은 과정을 진행시킴

</br> <ins> 마. 모델 관계도 </ins>
</br>
  </br>![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/d0296f87-65e4-4d6b-82a6-d4a2bcc6cdd4)

</br> <ins> 마. 최종적인 결과물</ins>
- 예시

|제품명|성별|리뷰|키|몸무게|총장|어깨너비|가슴단면|소매길이|
|------|---|------|---|------|---|------|---|------|
|무신사 맨투맨|남|" "|187|85|1|0|0|1|
|예일 맨투맨|여|" "|158|48|0|-1|0|1|
|라코스테 맨투맨|남|" "|167|58|0|0|0|-1|

- 위와 같은 형태로 데이터셋을 재정립하게 된면, 제품별로 성별, 키, 몸무게에 따라 느끼는 총장, 어깨너비, 가슴단면, 소매길이에 대해서 시각적으로 제시해줄 수 있다. 
- 만일 키 '160', 몸무게 '50'을 입력했을 경우 자기와 동일한 스펙을 가진 고객이 없을 가능성도 존재
- 이러한 경우를 대비하기 위해 키와 몸무게 모두 -2 ~ +2 범위의 스펙을 가진 고객의 데이터를 이용하여 streamlit을 활용해 dashboard를 제공

  
# </br> 두 번째 주제 : 고객이 입력한 키와 몸무게, 그리고 원하는 핏을 통해 사이즈를 예측해주는 dashboard 제공
</br> :pushpin: 1. train_data 변수에 대한 설명
- 첫 번째 모델에서 예측된 총장, 어깨너비, 가슴단면, 소매길이를 예측한 것을 feature로 추가하여 train_data를 구성

|변수 / 형태|종류|단위|비고|
|------|---|------|---|
|Product_name|질적 데이터 / 명목형||약 250개의 제품 존재|
|Gender|질적 데이터 / 명목형||남성, 여성 이진 분류|
|Height|양적 데이터 / 연속형|cm|남성, 여성의 키|
|Size|질적 데이터 / 순서형||S, M, L, XL|
|Length|양적 데이터 / 연속형|cm|제품 총장의 길이|
|Shoulder|양적 데이터 / 연속형|cm|제품 어깨의 길이|
|Chest|양적 데이터 / 연속형|cm|제품 가슴 둘레의 길이|
|Sleeve|양적 데이터 / 연속형|cm|제품 소매의 길이|
|총장|질적 데이터 / 순서형||길다 = 1, 정핏 = 0, 짧다 = -1|
|어깨너비|질적 데이터 / 순서형||크다 = 1, 정핏 = 0, 작다 = -1|
|가슴단면|질적 데이터 / 순서형||크다 = 1, 정핏 = 0, 작다 = -1|
|소매길이|질적 데이터 / 순서형||길다 = 1, 정핏 = 0, 짧다 = -1|

</br> :pushpin: 2. 데이터 전처리 & 기초 분석 

</br> <ins> 가. Height, Weight</ins>
- boxplot을 통해 비정상적으로 크거나 작은 고객의 키와 몸무게를 확인하고 제거

![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/70190918-8962-4eae-97f0-4f51deee990a)

```
1. Height는 200이상, 120이하를 제거 
2. Weight는 130이상, 20이하를 제거 
```

</br> <ins> 나. Height, Weight</ins>
- boxplot을 통해 비정상적으로 크거나 작은 총장, 어깨너비, 가슴단면, 소매길이를 제거

![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/3e84b1d3-1605-4537-a13e-62998363dde7)

</br> <ins> 다. Gender에 따른 Height, Weight 분포도</ins>

![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/55d13549-b35f-450d-9d08-ff6ef7727d54)

</br> :pushpin: 3. 모델링 작업 계획서

</br> <ins> 가. 데이터셋 구성</ins>
- 첫 번째 모델을 통해 예측한 총장, 어깨너비, 가슴단면, 소매길이를 추가시켜 데이터셋을 구성
- target변수는 총장, 어깨너비,가슴단면, 소매길이로 구성

|성별|키|몸무게|총장|어깨너비|가슴단면|소매|Length|Shoulder|Chest|Sleeve|
|------|---|------|---|------|---|------|---|------|---|------|
|남성|178|80|1|0|0|1|71|48.5|54.5|63|
|여성|162|54|-1|1|0|0|79|46.5|52|61|
|남성|175|57|1|0|0|0|71|62|65|57|
|여성|165|57|0|1|1|0|71|62|65|57|

</br> <ins> 나. train_data & test_data</ins>
- KFold 방식을 통해 학습데이터와 테스트데이터를 분류 (전체 데이터셋에서 학습데이터트 80%, 데스트데이터는 20%)
- 전체 데이터셋에서 학습데이터는 80%, 테스트데이터는 20%

![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/fe7e232c-5989-4f3a-94e7-b6cf8ce7766d)

![image](https://github.com/TaeseongYang/Musinsa_project/assets/156265617/3e3ea0e1-0fbc-412b-bb87-f9d1b8192651)


```
Q. train_data와 test_data 분류 작업은 잘 행해졌는가?
A. 대표적으로 Height와 Weight를 통해 train_data와 test_data의 분포도를 확인하여 분류 작업이 잘 행해졌는지 확인

1. Height의 경우에는 비슷한 분포도를 보이고 있음

2. Weight의 경우에도 비슷한 분포도를 보이고 있음

Q. 이를 통해 확인할 수 있는 사실은?
A. 전체 모든 변수를 다 확인한 것은 아니지만 대표적인 두 변수의 분포가 비슷한 것으로 보아 train_data와 test_data로 분류작업이 잘 행해진 것을 확인할 수 있음
```

</br> <ins> 다. pycaret을 활용한 모델링 과정 진행 </ins>

- Length를 예측해주는 모델링, Shoulder를 예측해주는 모델링, Chest를 예측해주는 모델링, Sleeve를 예측해주는 모델링을 pycaret를 통해서 진행
- 평가 방법은 RMSE를 사용 (0에 가까울수록 좋은 성능을 보여줌)

|변수명|RandomForestRegressor 성능|
|------|---|
|Length|2.7470|
|Shoulder|5.8568|
|Chest|7.8397|
|Sleeve|10.8222|

- 이를 활용하여 streamlit을 통해 맨투맨, 니트의 사이즈를 예측하는 Dashboard를 구성
